# 2026-02-11 - OpenClaw Gateway Outage & Recovery

## Incident Summary
Gateway crashed and became unresponsive mid-conversation. Required extensive debugging and manual config repair to restore service.

## Root Cause
- `sandbox.mode: "isolated"` requires Docker Desktop running
- Running `openclaw doctor --fix` attempted to "fix" the config but wrote an invalid value
- Result: `agents.defaults.sandbox.mode: Invalid input` error on gateway startup
- Gateway crashed immediately, cutting all connections

## Resolution Steps
1. **Initial attempts failed**:
   - Editing `sandbox.mode` to `"off"` or `"restricted"` didn't work (schema validator stuck)
   - Clearing temp/cache files didn't help
   - Doctor kept reporting same error

2. **What actually fixed it**:
   - Replaced entire complex `agents` section with minimal version
   - Set `sandbox.mode: "off"` (bypasses Docker requirement)
   - Forward slashes for workspace path: `C:/Users/miket/.openclaw/workspace`

3. **Full config restored**:
   - Model aliases: Kimi, GeminiFlash, GeminiPro
   - Agents: main, flash, pro
   - Memory search: enabled with session memory
   - Context pruning: 45min TTL, keep last 3
   - Subagents: Flash model, 8 concurrent

4. **Discord disabled**:
   - Removed token (was "back")
   - Set `enabled: false` in channels and plugins

5. **Scheduled task reinstalled**:
   - `openclaw gateway install` (requires Admin PowerShell)
   - Auto-start on boot confirmed working

## Lessons Learned
- **Never use `doctor --fix`** — it can corrupt working configs. Use `doctor` to diagnose only, fix manually.
- **Sandbox modes**:
  - `"isolated"` = requires Docker Desktop (don't use if no Docker)
  - `"restricted"` = asks permission before code execution
  - `"off"` = disables sandbox entirely (safest for Windows without Docker)
- **Config is fragile** — 2026.2.9 uses strict Zod schema. One bad field cascades into misleading errors.
- **Backup your config** before any changes:
  ```powershell
  Copy-Item ~/.openclaw/openclaw.json ~/.openclaw/openclaw.json.backup
  ```
- **If gateway won't start**: Rename config, run `openclaw onboard` for fresh config, migrate settings back manually.

## Prevention Checklist
- [ ] Keep config backup
- [ ] Avoid `--fix` flag on doctor
- [ ] Set `sandbox.mode: "off"` (no Docker needed)
- [ ] Monitor scheduled task health

## Current Status
✅ Gateway running stable
✅ All models and agents restored  
✅ Discord disabled
✅ Auto-start on boot enabled
